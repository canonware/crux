################################################################################
#
# <Copyright = jasone>
# <License>
#
################################################################################
#
# Version: Crux <Version = Crux>
#
################################################################################

print "Test begin"

taxonMap = Crux.TaxonMap.TaxonMap(['A', 'B', 'C', 'D', 'E',
                                   'F', 'G', 'H', 'I', 'J'])

trees = ["(A,B);",

         "(A,(B,C));",
         "(A,B,C);",

         "(A,B,C,D);",
         "((A,B),(C,D));",

         "(A,B,C,D,E);",
         "((A,B),(C,D,E));",
         "((A,B),C,(D,E));",

         "(A,B,C,D,E,F);",
         "((A,B),(C,D,E,F));",
         "((A,B,C),(D,E,F));",
         "((A,B,C),D,(E,F));",
         "(((A,B),C),(D,(E,F)));",
         "((A,B),(C,D),(E,F));"
         ]

for tree in trees:
    s = Crux.Tree.Tree(tree, taxonMap)
    s.canonize()
    print "====================================="
    sys.stdout.write("=== ")
    print s.render(labels=True)
    nNeighbors = s.tbrNNeighborsGet()
    for i in xrange(nNeighbors):
        t = Crux.Tree.Tree(tree, taxonMap)
        t.canonize()
        tbrArgs = t.tbrNeighborGet(i)
        sys.stdout.write("%d/%d (%r, %r, %r) --> " \
                         % (i, nNeighbors, type(tbrArgs[0]), type(tbrArgs[1]),
                            type(tbrArgs[2])))
        #sys.stdout.flush()
        revTbrArgs = t.tbr(tbrArgs)
        t.canonize()
        print t.render(labels=True)

print "====================================="

print "Test end"
